import numpy as np
import matplotlib.pyplot as plt
#import os
import pywt
#import pywt.data
#import pandas as pd

signal_a = np.array([9.81,233.83333,-152.5,-20.33333,233.83333,-233.83333,193.16667,-30.5,-40.66667,-111.83333,-81.33333,40.66667,-152.5,-122,305,193.16667,-233.83333,315.16667,-162.66667,10.16667,30.5,1.11022E-12,122,71.16667,183,91.5,-345.66667,-193.16667,111.83333,-264.33333,-30.5,142.33333,-111.83333,111.83333,-71.16667,30.5,-71.16667,-81.33333,0,40.66667,-71.16667,30.5,152.5,-40.66667,10.16667,-152.5,71.16667,-355.83333,-40.66667,-10.16667,-101.66667,10.16667,142.33333,-10.16667,-122,-81.33333,101.66667,142.33333,61,315.16667,61,71.16667,132.16667,-20.33333,71.16667,61,91.5,91.5,91.5,-10.16667,-111.83333,-40.66667,-20.33333,-71.16667,233.83333,10.16667,-40.66667,61,61,101.66667,-40.66667,111.83333,122,172.83333,183,223.66667,-20.33333,183,223.66667,81.33333,152.5,172.83333,233.83333,172.83333,254.16667,172.83333,274.5,213.5,284.66667,274.5,213.5,335.5,193.16667,142.33333,213.5,203.33333,162.66667,152.5,132.16667,172.83333,61,81.33333,50.83333,50.83333,91.5,101.66667,71.16667,61,50.83333,40.66667,40.66667,30.5,20.33333,10.16667,10.16667,-20.33333,30.5,-10.16667,-10.16667,20.33333,30.5,-20.33333,-61,-30.5,10.16667,40.66667,-20.33333,30.5,-10.16667,-20.33333,-40.66667,-20.33333,-40.66667,-20.33333,71.16667,-10.16667,30.5,-10.16667,20.33333,-20.33333,-20.33333,20.33333,20.33333,-40.66667,0,-20.33333,-20.33333,-30.5,-50.83333,0,101.66667,30.5,20.33333,10.16667,-30.5,0,8.4562E-12,-30.5,-61,4.62593E-12,-20.33333,-40.66667,-172.83333,-10.16667,0,-50.83333,20.33333,10.16667,-8.4562E-12,71.16667,20.33333,-40.66667,-20.33333,-10.16667,50.83333,-10.16667,-20.33333,-30.5,-50.83333,-61,10.16667,-10.16667,40.66667,40.66667,-20.33333,-61,10.16667,-30.5,-20.33333,-20.33333,4.62593E-12,-20.33333,-61,-40.66667,-20.33333,-61,50.83333,4.62593E-12,-81.33333,-20.33333,0,40.66667,40.66667,91.5,40.66667,-30.5,-61,61,-40.66667,30.5,30.5,20.33333,-50.83333,-9.25186E-12,-10.16667,-71.16667,4.62593E-12,-2.31296E-12,2.20194E-12,-50.83333,81.33333,20.33333,40.66667,-10.16667,20.33333,-50.83333,-81.33333,-10.16667,-61,-10.16667,-2.20194E-12,-20.33333,-132.16667,-81.33333,-71.16667,-71.16667,-10.16667,30.5,81.33333,-20.33333,61,30.5,-10.16667,71.16667,40.66667,20.33333,50.83333,40.66667,-10.16667,-20.33333,-10.16667,81.33333,-20.33333,-50.83333,-2.31296E-12,-40.66667,-10.16667,-40.66667,-40.66667,2.31296E-12,-30.5,-50.83333,-111.83333,-61,-30.5,-10.16667,10.16667,-40.66667,-30.5,30.5,-30.5,-50.83333,10.16667,10.16667,50.83333,-10.16667,-40.66667,10.16667,-10.16667,-10.16667,-10.16667,30.5,-20.33333,-10.16667,-30.5,30.5,-10.16667,-30.5,10.16667,0,-20.33333,-30.5,10.16667,-61,-30.5,20.33333,-10.16667,-40.66667,-10.16667,0,0,0,-20.33333,2.31296E-12,0,10.16667,-4.62593E-12,-10.16667,-6.93889E-12,-30.5,20.33333,-20.33333,-40.66667,-20.33333,-30.5,30.5,-10.16667,-40.66667,20.33333,-10.16667,-10.16667,20.33333,-40.66667,-9.25186E-12,10.16667,-20.33333,30.5,-30.5,-10.16667,-10.16667,-50.83333,-30.5,-10.16667,-20.33333,-6.93889E-12,-10.16667,-10.16667,6.93889E-12,-40.66667,0,-30.5,-10.16667,20.33333,-10.16667,-6.93889E-12,20.33333,4.62593E-12,-20.33333,-40.66667,10.16667,10.16667,-20.33333,10.16667,6.93889E-12,-81.33333,-20.33333,30.5,-30.5,-30.5,-50.83333,20.33333,-40.66667,-10.16667,-10.16667,-30.5,-30.5,81.33333,10.16667,-61,6.93889E-12,20.33333,50.83333,-81.33333,-10.16667,-30.5,-10.16667,10.16667,30.5,0,-20.33333,-20.33333,71.16667,-40.66667,-40.66667,30.5,9.25186E-12,-6.93889E-12,-20.33333,-20.33333,-30.5,-30.5,20.33333,-50.83333,-50.83333,4.62593E-12,10.16667,20.33333,-20.33333,0,-20.33333,10.16667,10.16667,-30.5,0,30.5,-81.33333,-20.33333,-20.33333,-40.66667,-20.33333,-40.66667,10.16667,-10.16667,-61,-30.5,-40.66667,0,0,-30.5,2.31296E-12,-2.31296E-12,-20.33333,30.5,-10.16667,-20.33333,30.5,30.5,122,-6.93889E-12,40.66667,122,4.62593E-12,-81.33333,-6.93889E-12,-50.83333,-30.5,30.5,30.5,20.33333,-111.83333,0,-30.5,-81.33333,-10.16667,101.66667,0,30.5,-2.31296E-12,-30.5,-50.83333,-50.83333,-61,-30.5,20.33333,-30.5,-10.16667,-10.16667,6.93889E-12,-20.33333,0,-30.5,-40.66667,-10.16667,10.16667,-10.16667,-71.16667,-50.83333,0,-20.33333,-10.16667,-50.83333,10.16667,0,20.33333,-20.33333,20.33333,-10.16667,20.33333,20.33333,-30.5,-61,-10.16667,10.16667,-30.5,-10.16667,-10.16667,20.33333,-20.33333,10.16667,-30.5,-10.16667,-10.16667,10.16667,0,30.5,-2.31296E-12,-20.33333,-30.5,-10.16667,0,-20.33333,-20.33333,-10.16667,-10.16667,30.5,-10.16667,20.33333,-30.5,-20.33333,0,-71.16667,-30.5,-20.33333,40.66667,-10.16667,20.33333,-50.83333,-20.33333,-61,40.66667,-10.16667,-10.16667,71.16667,20.33333,30.5,-40.66667,-40.66667,-20.33333,10.16667,-10.16667,-50.83333,-20.33333,20.33333,-10.16667,-81.33333,-50.83333,-40.66667,30.5,10.16667,-10.16667,4.62593E-12,-30.5,10.16667,0,-10.16667,-10.16667,40.66667,10.16667,61,-71.16667,30.5,-10.16667,-20.33333,50.83333,-20.33333,-20.33333,-40.66667,30.5,-10.16667,-10.16667,-81.33333,50.83333,20.33333,-40.66667,-10.16667,-61,40.66667,30.5,50.83333,-30.5,-20.33333,10.16667,40.66667,-40.66667,-20.33333,20.33333,61,30.5,40.66667,-61,0,-10.16667,71.16667,0,-10.16667,20.33333,30.5,30.5,-10.16667,40.66667,10.16667,61,20.33333,81.33333,-20.33333,81.33333,71.16667,50.83333,10.16667,30.5,71.16667,71.16667,61,81.33333,101.66667,111.83333,81.33333,40.66667,101.66667,101.66667,111.83333,122,111.83333,91.5,61,91.5,61,40.66667,91.5,111.83333,40.66667,71.16667,71.16667,81.33333,-10.16667,81.33333,91.5,10.16667,40.66667,61,40.66667,4.62593E-12,40.66667,40.66667,40.66667,10.16667,71.16667,-20.33333,-30.5,50.83333,10.16667,30.5,0,50.83333,0,10.16667,-20.33333,-20.33333,-30.5,0,20.33333,-40.66667,20.33333,-40.66667,40.66667,-20.33333,-30.5,-30.5,20.33333,20.33333,40.66667,20.33333,-4.62593E-12,-9.25186E-12,9.25186E-12,-10.16667,-40.66667,-10.16667,10.16667,10.16667,-10.16667,-30.5,-30.5,0,4.62593E-12,-4.62593E-12,4.62593E-12,-10.16667,20.33333,-10.16667,-10.16667,-10.16667,-20.33333,30.5,0,-30.5,-20.33333,1.36557E-11,-71.16667,20.33333,-40.66667,20.33333,20.33333,-10.16667,-40.66667,0,-30.5,-30.5,10.16667,-9.02981E-12,20.33333,-50.83333,-20.33333,-10.16667,-20.33333,-20.33333,20.33333,-71.16667,0,-4.62593E-12,-30.5,-20.33333,-20.33333,-10.16667,20.33333,-40.66667,-50.83333,-10.16667,-10.16667,30.5,20.33333,-10.16667,-20.33333,-20.33333,0,-10.16667,-20.33333,20.33333,10.16667,0,-30.5,10.16667,-10.16667,-40.66667,0,30.5,0,20.33333,0,0,10.16667,-10.16667,20.33333,-10.16667,-50.83333,10.16667,30.5,-40.66667,-40.66667,0,-20.33333,-40.66667,20.33333,-9.25186E-12,-20.33333,-81.33333,10.16667,20.33333,-40.66667,-20.33333,10.16667,-40.66667,9.25186E-12,10.16667,-10.16667,9.25186E-12,10.16667,40.66667,-40.66667,-50.83333,-4.62593E-12,10.16667,-20.33333,-20.33333,20.33333,-40.66667,10.16667,10.16667,-20.33333,20.33333,-10.16667,30.5,-20.33333,0,10.16667,20.33333,-40.66667,-30.5,-71.16667,-50.83333,-20.33333,-40.66667,10.16667,-30.5,10.16667,-20.33333,-10.16667,-20.33333,-10.16667,20.33333,10.16667,10.16667,0,-20.33333,-30.5,20.33333,-50.83333,-61,-30.5,-10.16667,-40.66667,-40.66667,-20.33333,-20.33333,-30.5,-10.16667,20.33333,-40.66667,20.33333,61,30.5,-10.16667,20.33333,-10.16667,-20.33333,4.62593E-12,30.5,-30.5,0,-4.62593E-12,10.16667,-40.66667,-30.5,10.16667,4.62593E-12,30.5,-10.16667,-20.33333,0,20.33333,-10.16667,-10.16667,-40.66667,-10.16667,10.16667,-30.5,4.62593E-12,-4.62593E-12,10.16667,-9.25186E-12,-10.16667,-20.33333,-20.33333,-10.16667,0,0,-10.16667,-10.16667,-20.33333,-40.66667,-30.5,-50.83333,-30.5,-20.33333,-50.83333,-10.16667,-40.66667,-20.33333,-61,-40.66667,0,10.16667,10.16667,40.66667,-30.5,-1.36557E-11,10.16667,20.33333,40.66667,10.16667,30.5,61,-10.16667,-5.64363E-12,-30.5,-10.16667,40.66667,61,50.83333,-10.16667,-20.33333,-30.5,-20.33333,-30.5,10.16667,-61,10.16667,10.16667,-50.83333,-50.83333,-50.83333,-40.66667,0,10.16667,-4.62593E-12,20.33333,-40.66667,10.16667,-20.33333,-61,10.16667,-30.5,-20.33333,9.25186E-12,-30.5,-30.5,-10.16667,-20.33333,20.33333,0,-10.16667,10.16667,-30.5,30.5,10.16667,20.33333,20.33333,30.5,-10.16667,-50.83333,-10.16667,-10.16667,20.33333,10.16667,-10.16667,10.16667,-4.62593E-12,-20.33333,-1.38778E-11,10.16667,10.16667,50.83333,-20.33333,30.5,-20.33333,10.16667,-10.16667,-40.66667,10.16667,-20.33333,20.33333,-10.16667,10.16667,-30.5,61,10.16667,30.5,10.16667,71.16667,61,10.16667,40.66667,-30.5,10.16667,-4.62593E-12,30.5,-20.33333,20.33333,30.5,4.62593E-12,30.5,40.66667,61,10.16667,81.33333,91.5,61,40.66667,30.5,71.16667,50.83333,71.16667,40.66667,61,81.33333,132.16667,71.16667,-10.16667,20.33333,111.83333,111.83333,20.33333,50.83333,40.66667,30.5,-30.5,-40.66667,0,-10.16667,40.66667,20.33333,-20.33333,-40.66667,40.66667,-40.66667,30.5,1.12873E-11,20.33333,10.16667,-20.33333,50.83333,20.33333,30.5,30.5,20.33333,-50.83333,20.33333,-20.33333,30.5,-10.16667,40.66667,40.66667,-50.83333,20.33333,30.5,-71.16667,10.16667,9.25186E-12,20.33333,40.66667,-40.66667,30.5,9.25186E-12,-50.83333,40.66667,-61,-30.5,20.33333,0,61,10.16667,-40.66667,0,1.38778E-11,-30.5,0,-30.5,10.16667,0,10.16667,-10.16667,-50.83333,-20.33333,-10.16667,10.16667,-4.62593E-12,10.16667,-10.16667,-20.33333,10.16667,10.16667,-4.62593E-12,-10.16667,-10.16667,-20.33333,0,-10.16667,-20.33333,-20.33333,20.33333,-4.62593E-12,0,-10.16667,-40.66667,-10.16667,10.16667,0,0,0,-30.5,-10.16667,-10.16667,-30.5,-20.33333,-20.33333,10.16667,-10.16667,20.33333,-10.16667,-30.5,-20.33333])
signal_v = np.array([-9.904,-12.932,-6.344,-9.516,-12.932,-6.344,-10.98,-10.248,-9.028,-8.296,-10.004,-10.004,-10.004,-7.32,-10.004,-10.004,-7.32,-11.956,-6.344,-10.98,-10.004,-10.98,-11.956,-9.028,-13.664,-10.248,-2.684,-5.368,-12.932,-4.392,-10.248,-10.736,-9.272,-10.98,-9.028,-7.32,-9.272,-8.052,-10.98,-10.004,-10.248,-10.736,-10.98,-7.32,-11.956,-8.296,-10.736,-6.588,-10.98,-10.004,-10.98,-9.028,-11.956,-10.004,-7.32,-8.296,-11.712,-11.956,-9.028,-15.128,-11.956,-10.248,-13.42,-8.784,-8.54,-10.248,-10.248,-10.248,-9.272,-8.54,-7.564,-7.564,-10.492,-8.54,-10.248,-9.272,-6.832,-8.784,-8.052,-8.052,-7.076,-8.784,-10.248,-8.54,-10.98,-10.248,-4.636,-9.028,-7.808,-7.32,-6.588,-5.612,-8.052,-6.1,-7.32,-4.392,-6.588,-4.88,-5.124,-4.636,-2.44,-5.368,-2.928,-1.464,-2.44,-1.952,-1.22,-0.244,0,0.244,1.708,1.952,2.684,2.684,1.708,1.952,2.684,2.928,2.684,3.416,3.172,4.392,3.172,3.904,3.904,3.904,3.904,4.392,4.392,4.392,3.904,4.392,4.148,5.124,3.66,4.148,4.148,3.416,4.636,4.148,4.148,4.88,4.636,3.904,2.684,4.392,3.904,5.124,3.66,4.148,4.392,3.66,3.172,4.392,3.66,3.416,4.392,4.148,4.636,4.88,4.148,3.66,3.904,4.148,3.66,3.416,3.66,2.928,3.904,3.416,3.416,4.88,6.588,4.392,4.392,4.392,2.928,3.416,3.66,2.196,2.44,3.416,2.928,3.904,2.44,4.148,4.392,3.172,3.416,3.66,3.66,3.904,2.928,2.44,2.44,3.66,3.66,3.904,3.904,2.44,2.196,2.196,3.904,3.66,3.904,3.416,1.952,2.196,3.904,3.172,3.416,1.952,2.196,1.708,2.44,2.684,3.416,1.952,3.172,2.196,1.952,2.684,3.416,2.928,3.172,3.904,3.416,1.952,1.952,3.416,2.196,2.928,2.684,3.172,2.196,2.928,2.928,2.196,3.416,1.952,1.952,2.196,4.148,3.416,3.66,2.928,2.684,1.708,0.976,1.952,1.952,1.708,1.952,1.708,0.976,1.464,1.952,1.22,2.44,2.44,2.928,1.464,3.416,2.44,1.708,3.416,1.952,1.952,3.172,2.196,2.196,1.952,2.684,3.416,2.928,1.22,1.708,2.44,1.708,0.976,2.196,2.196,1.464,0.732,0,1.952,2.196,0.976,1.952,1.464,0.976,1.708,1.464,0.976,1.708,0.976,1.22,1.708,1.22,1.22,1.708,1.22,0.732,2.44,0.976,0.732,0.976,1.708,0.976,0.976,1.464,1.22,1.22,0.488,0.976,0.976,0.244,1.22,0.732,0.732,0.732,0.976,1.464,1.22,0.732,0.488,0.976,1.22,0.244,0.976,0.732,0,1.22,0.488,0.488,0.732,0,1.22,0.732,0.244,0.732,0.732,0.488,0.488,0.244,0.488,0.732,0.244,0.732,0.488,0.488,0,-0.488,0,0.244,0,0.244,0.244,0.488,0.244,-0.244,0.488,-0.244,-0.244,0,-0.244,0.244,0.488,0.244,-0.244,-0.488,0.488,0,0,0,-0.244,-1.952,-0.732,0.976,-0.244,-0.488,-1.464,0,-0.488,-0.244,-0.244,-0.732,-0.976,0,-0.488,-0.488,-0.244,0,-0.244,-1.952,-0.732,-0.976,-0.488,-0.488,-0.244,0,-0.976,-0.976,1.464,-0.976,-1.22,-1.22,-0.732,-0.976,-0.976,-0.976,-0.976,-0.732,-0.488,-2.196,0.244,-0.976,-0.976,-0.732,-1.22,-0.976,-1.464,-0.732,-0.732,-1.464,-0.488,-1.464,-1.708,-1.464,-1.464,-1.708,-1.708,-1.952,-1.22,-0.976,-2.196,-2.196,-1.464,-1.464,-1.708,-2.196,-1.464,-1.708,-2.196,-1.22,-1.464,-1.464,-1.464,-1.464,1.464,-1.464,-0.732,0.732,-1.464,-3.66,-2.196,-2.44,-2.196,-0.732,-0.732,-0.976,-1.22,-1.464,-1.464,-1.22,-1.708,-1.22,-2.196,-1.708,-2.196,-1.464,-1.952,-2.196,-2.684,-2.196,-0.976,-1.952,-1.952,-1.464,-2.196,-2.196,-2.196,-2.196,-2.928,-2.44,-2.44,-2.44,-2.684,-3.172,-1.952,-1.952,-2.44,-3.416,-1.952,-2.196,-2.44,-2.928,-1.952,-2.684,-2.196,-2.684,-2.684,-3.416,-2.684,-3.172,-2.684,-2.44,-2.684,-2.44,-2.44,-2.44,-2.928,-2.928,-2.928,-3.172,-2.684,-2.44,-2.684,-2.928,-3.416,-2.684,-2.44,-2.928,-3.416,-3.172,-3.172,-2.44,-2.928,-1.952,-3.416,-3.416,-3.416,-4.392,-3.172,-3.416,-2.44,-3.416,-2.684,-3.66,-3.416,-3.416,-2.44,-3.66,-3.66,-2.684,-2.684,-2.684,-3.416,-4.392,-3.172,-3.416,-3.66,-4.636,-2.928,-3.172,-3.904,-4.636,-3.904,-3.66,-2.684,-4.148,-3.416,-3.416,-4.392,-4.392,-2.928,-3.416,-4.148,-3.66,-3.66,-2.196,-4.392,-3.416,-3.66,-3.904,-3.172,-4.88,-3.416,-4.392,-3.416,-3.904,-3.904,-4.148,-3.172,-2.928,-4.636,-4.148,-4.636,-3.904,-2.684,-3.172,-4.148,-4.392,-3.66,-3.172,-4.148,-3.416,-4.148,-2.684,-3.904,-2.928,-4.148,-3.172,-4.392,-2.684,-3.66,-3.416,-3.66,-2.684,-3.416,-2.928,-2.928,-2.684,-2.684,-2.684,-2.44,-3.172,-1.708,-1.708,-2.44,-2.44,-2.684,-1.22,-1.22,-1.22,-0.732,-0.244,0.244,-1.22,-0.732,0.732,0,0.244,0.244,1.464,0.976,0.244,1.464,1.22,1.22,0.976,1.952,1.708,1.708,1.952,2.196,1.22,2.928,2.44,1.708,2.196,2.684,1.952,1.952,2.684,2.684,2.928,2.44,2.928,2.44,1.708,2.928,2.44,3.416,1.952,3.172,2.684,2.928,2.44,1.952,2.196,2.44,2.196,1.952,2.928,2.44,2.928,2.684,1.952,2.196,2.928,2.44,3.172,2.928,2.196,1.952,2.928,2.196,1.952,2.44,2.196,2.44,2.684,1.708,2.44,2.928,2.196,1.952,2.928,1.952,2.44,2.196,1.952,2.196,2.196,2.44,2.44,2.196,1.708,1.952,1.22,2.44,1.464,2.684,2.44,1.952,1.22,2.44,1.708,1.464,1.952,1.952,1.708,1.22,0.976,2.44,1.952,1.464,1.708,0.732,1.708,1.464,1.22,1.464,1.22,0.976,1.464,1.464,0.732,1.22,1.464,1.464,2.196,1.22,0.732,0.976,1.22,0.732,0.976,1.952,0.976,1.22,0.732,1.708,1.952,0.244,0.732,1.708,1.22,1.22,0.976,1.952,1.22,0.976,1.22,1.464,0.732,0.488,1.464,0.732,0.244,1.22,0.488,0.976,1.708,0.976,0.732,-0.488,0.976,0.976,0.488,0.244,0.488,0.244,0.488,1.22,1.464,0.976,0.976,0.488,0,-0.244,0.488,0.488,0,-0.244,0.976,0.244,1.708,1.22,0.488,0.976,-0.244,0.488,0,0.488,0.244,0.244,0,-0.488,0,0,0,0,0,-0.244,0.244,0,0,-0.244,-0.244,0,0.244,0.244,0,-0.488,-0.732,0.244,-0.976,-1.464,-0.732,-0.488,-1.22,-0.976,-0.244,-0.244,-0.732,-0.732,-0.244,-0.732,-0.488,0,0,-0.732,-0.732,-1.22,-0.732,-0.244,0,-1.464,-0.244,-0.732,-0.244,-0.976,-0.732,-0.488,-0.732,-0.488,-0.976,-0.732,0,-0.976,-0.488,-0.976,-1.22,-1.22,-0.488,-1.22,-0.732,-0.488,-0.732,-0.732,-0.244,-1.464,-0.976,-1.22,-1.22,-1.22,-0.732,-1.464,-1.22,-1.464,-1.464,-1.952,-0.976,-1.952,-2.196,-1.464,-2.196,-1.708,-2.196,-2.44,-1.22,-1.22,-1.22,-0.976,-1.708,-1.952,-1.952,-0.976,-1.22,-1.464,-1.464,-0.976,-1.464,-1.22,-1.952,-1.22,-0.732,-0.488,-0.732,-1.22,-1.708,-2.196,-1.952,-1.708,-1.22,-2.684,-1.708,-0.976,-1.952,-1.708,-1.952,-2.196,-1.708,-1.952,-1.952,-1.22,-2.196,-2.44,-2.196,-2.44,-1.708,-2.44,-2.44,-2.196,-2.44,-2.684,-2.196,-1.708,-1.708,-2.44,-2.44,-2.196,-2.44,-1.708,-2.196,-1.708,-1.952,-1.952,-2.44,-2.928,-1.952,-2.684,-1.952,-1.952,-2.684,-1.464,-2.196,-2.196,-1.952,-1.708,-2.196,-1.708,-2.44,-1.952,-2.44,-1.708,-2.928,-2.44,-1.952,-2.684,-1.464,-1.952,-1.952,-2.44,-0.976,-1.708,-1.708,-1.464,-1.22,-0.976,-1.708,-1.708,-2.196,-1.708,-1.952,-1.708,-1.464,-1.22,-0.976,-1.464,-0.488,0,-0.244,-1.464,-0.244,0.488,-0.488,-0.732,-0.732,0.488,0.244,0.244,0.488,1.464,1.708,1.708,1.464,0.244,0,1.952,1.952,0.976,1.464,1.22,1.22,0.732,0.732,1.708,1.22,1.22,0.488,1.464,0.976,1.952,0.488,1.952,1.22,1.22,0.976,1.22,2.44,1.708,1.22,2.196,1.464,0.732,0.976,1.464,1.952,0.976,1.952,2.196,1.22,2.196,1.952,0.488,1.708,0.732,1.464,2.44,0.976,1.708,1.952,0.976,2.196,0.732,1.22,0.976,1.708,2.196,1.708,1.464,0.976,1.708,1.22,0.976,1.464,0.976,1.22,1.22,1.464,0.976,1.22,1.22,1.22,1.708,1.464,0.732,0.976,1.22,1.464,1.22,1.22,0.732,0.732,1.22,0.976,1.22,0.976,1.22,0.976,1.22,1.22,0.244,0.976,0.976,0.732,1.22,0.976])
signal_s = np.array([0,-0.02586,-0.03855,-0.05758,-0.08345,-0.09614,-0.1181,-0.13859,-0.15665,-0.17324,-0.19325,-0.21326,-0.23326,-0.2479,-0.26791,-0.28792,-0.30256,-0.32647,-0.33916,-0.36112,-0.38113,-0.40309,-0.427,-0.44506,-0.47238,-0.49288,-0.49825,-0.50898,-0.53485,-0.54363,-0.56413,-0.5856,-0.60414,-0.6261,-0.64416,-0.6588,-0.67734,-0.69345,-0.71541,-0.73542,-0.75591,-0.77738,-0.79934,-0.81398,-0.8379,-0.85449,-0.87596,-0.88914,-0.9111,-0.9311,-0.95306,-0.97112,-0.99503,-1.01504,-1.02968,-1.04627,-1.0697,-1.09361,-1.11166,-1.14192,-1.16583,-1.18633,-1.21317,-1.23074,-1.24782,-1.26831,-1.28881,-1.3093,-1.32785,-1.34493,-1.36006,-1.37518,-1.39617,-1.41325,-1.43374,-1.45229,-1.46595,-1.48352,-1.49962,-1.51573,-1.52988,-1.54745,-1.56794,-1.58502,-1.60698,-1.62748,-1.63675,-1.65481,-1.67042,-1.68506,-1.69824,-1.70946,-1.72557,-1.73777,-1.75241,-1.76119,-1.77437,-1.78413,-1.79438,-1.80365,-1.80853,-1.81926,-1.82512,-1.82805,-1.83293,-1.83683,-1.83927,-1.83976,-1.83976,-1.83927,-1.83586,-1.83195,-1.82658,-1.82122,-1.8178,-1.8139,-1.80853,-1.80267,-1.7973,-1.79047,-1.78413,-1.77534,-1.769,-1.76119,-1.75338,-1.74558,-1.73777,-1.72898,-1.7202,-1.71142,-1.70361,-1.69482,-1.68653,-1.67628,-1.66896,-1.66066,-1.65237,-1.64554,-1.63626,-1.62797,-1.61967,-1.60991,-1.60064,-1.59283,-1.58746,-1.57868,-1.57087,-1.56062,-1.5533,-1.54501,-1.53622,-1.5289,-1.52256,-1.51378,-1.50646,-1.49962,-1.49084,-1.48254,-1.47327,-1.46351,-1.45522,-1.4479,-1.44009,-1.43179,-1.42447,-1.41764,-1.41032,-1.40446,-1.39666,-1.38982,-1.38299,-1.37323,-1.36006,-1.35127,-1.34249,-1.3337,-1.32785,-1.32102,-1.3137,-1.3093,-1.30442,-1.29759,-1.29174,-1.28393,-1.27905,-1.27075,-1.26197,-1.25562,-1.24879,-1.24147,-1.23415,-1.22634,-1.22049,-1.21561,-1.21073,-1.20341,-1.19609,-1.18828,-1.18047,-1.17559,-1.1712,-1.16681,-1.159,-1.15168,-1.14387,-1.13704,-1.13314,-1.12874,-1.12094,-1.11459,-1.10776,-1.10386,-1.09946,-1.09605,-1.09117,-1.0858,-1.07897,-1.07506,-1.06872,-1.06433,-1.06042,-1.05506,-1.04822,-1.04237,-1.03602,-1.02822,-1.02138,-1.01748,-1.01358,-1.00674,-1.00235,-0.9965,-0.99113,-0.98478,-0.98039,-0.97454,-0.96868,-0.96429,-0.95746,-0.95355,-0.94965,-0.94526,-0.93696,-0.93013,-0.92281,-0.91695,-0.91158,-0.90817,-0.90622,-0.90231,-0.89841,-0.89499,-0.89109,-0.88767,-0.88572,-0.88279,-0.87889,-0.87645,-0.87157,-0.86669,-0.86083,-0.8579,-0.85107,-0.84619,-0.84278,-0.83594,-0.83204,-0.82814,-0.82179,-0.8174,-0.81301,-0.8091,-0.80374,-0.7969,-0.79105,-0.78861,-0.78519,-0.78031,-0.7769,-0.77494,-0.77055,-0.76616,-0.76323,-0.76177,-0.76177,-0.75786,-0.75347,-0.75152,-0.74762,-0.74469,-0.74274,-0.73932,-0.73639,-0.73444,-0.73102,-0.72907,-0.72663,-0.72322,-0.72078,-0.71834,-0.71492,-0.71248,-0.71102,-0.70614,-0.70418,-0.70272,-0.70077,-0.69735,-0.6954,-0.69345,-0.69052,-0.68808,-0.68564,-0.68466,-0.68271,-0.68076,-0.68027,-0.67783,-0.67637,-0.6749,-0.67344,-0.67149,-0.66856,-0.66612,-0.66466,-0.66368,-0.66173,-0.65929,-0.6588,-0.65685,-0.65538,-0.65538,-0.65294,-0.65197,-0.65099,-0.64953,-0.64953,-0.64709,-0.64562,-0.64514,-0.64367,-0.64221,-0.64123,-0.64026,-0.63977,-0.63879,-0.63733,-0.63684,-0.63538,-0.6344,-0.63342,-0.63342,-0.6344,-0.6344,-0.63391,-0.63391,-0.63342,-0.63294,-0.63196,-0.63147,-0.63196,-0.63098,-0.63147,-0.63196,-0.63196,-0.63245,-0.63196,-0.63098,-0.6305,-0.63098,-0.63196,-0.63098,-0.63098,-0.63098,-0.63098,-0.63147,-0.63538,-0.63684,-0.63489,-0.63538,-0.63635,-0.63928,-0.63928,-0.64026,-0.64074,-0.64123,-0.6427,-0.64465,-0.64465,-0.64562,-0.6466,-0.64709,-0.64709,-0.64758,-0.65148,-0.65294,-0.6549,-0.65587,-0.65685,-0.65734,-0.65734,-0.65929,-0.66124,-0.65831,-0.66026,-0.6627,-0.66514,-0.66661,-0.66856,-0.67051,-0.67246,-0.67442,-0.67588,-0.67686,-0.68125,-0.68076,-0.68271,-0.68466,-0.68613,-0.68857,-0.69052,-0.69345,-0.69491,-0.69638,-0.6993,-0.70028,-0.70321,-0.70662,-0.70955,-0.71248,-0.7159,-0.71931,-0.72322,-0.72566,-0.72761,-0.732,-0.73639,-0.73932,-0.74225,-0.74566,-0.75006,-0.75298,-0.7564,-0.76079,-0.76323,-0.76616,-0.76909,-0.77202,-0.77494,-0.77202,-0.77494,-0.77641,-0.77494,-0.77787,-0.78519,-0.78958,-0.79446,-0.79886,-0.80032,-0.80178,-0.80374,-0.80618,-0.8091,-0.81203,-0.81447,-0.81789,-0.82033,-0.82472,-0.82814,-0.83253,-0.83546,-0.83936,-0.84375,-0.84912,-0.85351,-0.85546,-0.85937,-0.86327,-0.8662,-0.87059,-0.87498,-0.87938,-0.88377,-0.88962,-0.8945,-0.89938,-0.90426,-0.90963,-0.91598,-0.91988,-0.92378,-0.92866,-0.9355,-0.9394,-0.94379,-0.94867,-0.95453,-0.95843,-0.9638,-0.96819,-0.97356,-0.97893,-0.98576,-0.99113,-0.99747,-1.00284,-1.00772,-1.01309,-1.01797,-1.02285,-1.02773,-1.03358,-1.03944,-1.0453,-1.05164,-1.05701,-1.06189,-1.06726,-1.07311,-1.07994,-1.08531,-1.09019,-1.09605,-1.10288,-1.10922,-1.11557,-1.12045,-1.1263,-1.13021,-1.13704,-1.14387,-1.1507,-1.15949,-1.16583,-1.17266,-1.17754,-1.18438,-1.18974,-1.19706,-1.2039,-1.21073,-1.21561,-1.22293,-1.23025,-1.23562,-1.24098,-1.24635,-1.25318,-1.26197,-1.26831,-1.27514,-1.28246,-1.29174,-1.29759,-1.30394,-1.31174,-1.32102,-1.32882,-1.33614,-1.34151,-1.34981,-1.35664,-1.36347,-1.37226,-1.38104,-1.3869,-1.39373,-1.40202,-1.40934,-1.41666,-1.42106,-1.42984,-1.43667,-1.44399,-1.4518,-1.45814,-1.4679,-1.47474,-1.48352,-1.49035,-1.49816,-1.50597,-1.51426,-1.52061,-1.52646,-1.53574,-1.54403,-1.5533,-1.56111,-1.56648,-1.57282,-1.58112,-1.5899,-1.59722,-1.60357,-1.61186,-1.6187,-1.62699,-1.63236,-1.64017,-1.64602,-1.65432,-1.66066,-1.66945,-1.67482,-1.68214,-1.68897,-1.69629,-1.70166,-1.70849,-1.71434,-1.7202,-1.72557,-1.73094,-1.7363,-1.74118,-1.74753,-1.75094,-1.75436,-1.75924,-1.76412,-1.76949,-1.77193,-1.77437,-1.77681,-1.77827,-1.77876,-1.77827,-1.78071,-1.78218,-1.78071,-1.78071,-1.78022,-1.77974,-1.77681,-1.77486,-1.77437,-1.77144,-1.769,-1.76656,-1.76461,-1.7607,-1.75729,-1.75387,-1.74997,-1.74558,-1.74314,-1.73728,-1.7324,-1.72898,-1.72459,-1.71922,-1.71532,-1.71142,-1.70605,-1.70068,-1.69482,-1.68994,-1.68409,-1.67921,-1.67579,-1.66994,-1.66506,-1.65822,-1.65432,-1.64798,-1.64261,-1.63675,-1.63187,-1.62797,-1.62358,-1.6187,-1.6143,-1.6104,-1.60454,-1.59966,-1.59381,-1.58844,-1.58454,-1.58014,-1.57429,-1.56941,-1.56306,-1.55721,-1.55282,-1.54891,-1.54306,-1.53866,-1.53476,-1.52988,-1.52549,-1.52061,-1.51524,-1.51182,-1.50694,-1.50109,-1.4967,-1.49279,-1.48694,-1.48303,-1.47815,-1.47376,-1.46986,-1.46546,-1.46107,-1.45619,-1.45131,-1.44692,-1.4435,-1.4396,-1.43716,-1.43228,-1.42935,-1.42398,-1.4191,-1.4152,-1.41276,-1.40788,-1.40446,-1.40154,-1.39763,-1.39373,-1.39031,-1.38787,-1.38592,-1.38104,-1.37714,-1.37421,-1.37079,-1.36933,-1.36591,-1.36298,-1.36054,-1.35762,-1.35518,-1.35322,-1.3503,-1.34737,-1.3459,-1.34346,-1.34054,-1.33761,-1.33322,-1.33078,-1.32931,-1.32736,-1.32492,-1.32346,-1.3215,-1.3176,-1.31565,-1.31321,-1.31174,-1.30833,-1.30442,-1.30394,-1.30247,-1.29906,-1.29662,-1.29418,-1.29222,-1.28832,-1.28588,-1.28393,-1.28149,-1.27856,-1.2771,-1.27612,-1.27319,-1.27173,-1.27124,-1.2688,-1.26782,-1.26587,-1.26246,-1.2605,-1.25904,-1.26002,-1.25806,-1.25611,-1.25514,-1.25465,-1.25367,-1.25318,-1.25221,-1.24977,-1.24684,-1.24489,-1.24294,-1.24196,-1.24196,-1.24245,-1.24147,-1.2405,-1.2405,-1.24098,-1.23903,-1.23854,-1.23513,-1.23269,-1.23171,-1.22976,-1.23025,-1.22927,-1.22927,-1.2283,-1.22781,-1.22732,-1.22732,-1.2283,-1.2283,-1.2283,-1.2283,-1.2283,-1.2283,-1.22878,-1.2283,-1.2283,-1.2283,-1.22878,-1.22927,-1.22927,-1.22878,-1.2283,-1.2283,-1.22927,-1.23074,-1.23025,-1.2322,-1.23513,-1.23659,-1.23757,-1.24001,-1.24196,-1.24245,-1.24294,-1.2444,-1.24586,-1.24635,-1.24782,-1.24879,-1.24879,-1.24879,-1.25026,-1.25172,-1.25416,-1.25562,-1.25611,-1.25611,-1.25904,-1.25953,-1.26099,-1.26148,-1.26343,-1.2649,-1.26587,-1.26734,-1.26831,-1.27026,-1.27173,-1.27173,-1.27368,-1.27466,-1.27661,-1.27905,-1.28149,-1.28246,-1.2849,-1.28637,-1.28734,-1.28881,-1.29027,-1.29076,-1.29369,-1.29564,-1.29808,-1.30052,-1.30296,-1.30442,-1.30735,-1.30979,-1.31272,-1.31565,-1.31955,-1.3215,-1.32541,-1.3298,-1.33273,-1.33712,-1.34054,-1.34493,-1.34981,-1.35225,-1.35469,-1.35713,-1.35908,-1.3625,-1.3664,-1.3703,-1.37226,-1.3747,-1.37762,-1.38055,-1.3825,-1.38543,-1.38787,-1.39178,-1.39422,-1.39568,-1.39666,-1.39812,-1.40056,-1.40398,-1.40837,-1.41227,-1.41569,-1.41813,-1.4235,-1.42691,-1.42886,-1.43277,-1.43618,-1.44009,-1.44448,-1.4479,-1.4518,-1.4557,-1.45814,-1.46254,-1.46742,-1.47181,-1.47669,-1.4801,-1.48498,-1.48986,-1.49426,-1.49914,-1.5045,-1.5089,-1.51231,-1.51573,-1.52061,-1.52549,-1.52988,-1.53476,-1.53818,-1.54257,-1.54598,-1.54989,-1.55379,-1.55867,-1.56453,-1.56843,-1.5738,-1.5777,-1.58161,-1.58698,-1.5899,-1.5943,-1.59869,-1.60259,-1.60601,-1.6104,-1.61382,-1.6187,-1.6226,-1.62748,-1.6309,-1.63675,-1.64163,-1.64554,-1.6509,-1.65383,-1.65774,-1.66164,-1.66652,-1.66847,-1.67189,-1.6753,-1.67823,-1.68067,-1.68262,-1.68604,-1.68946,-1.69385,-1.69726,-1.70117,-1.70458,-1.70751,-1.70995,-1.7119,-1.71483,-1.71581,-1.71581,-1.7163,-1.71922,-1.71971,-1.71874,-1.71971,-1.72118,-1.72264,-1.72166,-1.72118,-1.72069,-1.71971,-1.71678,-1.71337,-1.70995,-1.70702,-1.70654,-1.70654,-1.70263,-1.69873,-1.69678,-1.69385,-1.69141,-1.68897,-1.6875,-1.68604,-1.68262,-1.68018,-1.67774,-1.67677,-1.67384,-1.67189,-1.66798,-1.66701,-1.6631,-1.66066,-1.65822,-1.65627,-1.65383,-1.64895,-1.64554,-1.6431,-1.6387,-1.63578,-1.63431,-1.63236,-1.62943,-1.62553,-1.62358,-1.61967,-1.61528,-1.61284,-1.60845,-1.60454,-1.60357,-1.60015,-1.59869,-1.59576,-1.59088,-1.58893,-1.58551,-1.58161,-1.57966,-1.57526,-1.5738,-1.57136,-1.56941,-1.56599,-1.5616,-1.55818,-1.55526,-1.5533,-1.54989,-1.54745,-1.5455,-1.54257,-1.54062,-1.53818,-1.53574,-1.53281,-1.53086,-1.52842,-1.52598,-1.52354,-1.52012,-1.51719,-1.51573,-1.51378,-1.51134,-1.50841,-1.50597,-1.50353,-1.50206,-1.5006,-1.49816,-1.49621,-1.49377,-1.49182,-1.48938,-1.48742,-1.48498,-1.48254,-1.48206,-1.4801,-1.47815,-1.47669,-1.47425,-1.4723])
'''
signal_a = np.array([1,2,3,4,5,6,7,8])
'''
signal_origin = signal_s
max_level =3
wp = pywt.WaveletPacket(data=signal_origin, wavelet='haar',mode='symmetric',maxlevel=max_level)

#根据频段频率（freq）进行排序
for i in range(max_level):
	print([node.path for node in wp.get_level(i, 'freq')])
for j in range(max_level):
	print([node.path for node in wp.get_level(j, 'natural')])

print('pywt.families=', pywt.families())

# 第一层
a = wp['a'].data #第1个节点
d = wp['d'].data #第2个节点

#第二层
aa = wp['aa'].data 
ad = wp['ad'].data 
dd = wp['dd'].data 
da = wp['da'].data 

#第三层
aaa = wp['aaa'].data 
aad = wp['aad'].data 
ada = wp['add'].data 
add = wp['ada'].data 
daa = wp['dda'].data 
dad = wp['ddd'].data 
dda = wp['dad'].data 
ddd = wp['daa'].data

plt.subplot(4,1,1)
plt.plot(signal_origin)
#第一层
plt.subplot(4,2,3)
plt.plot(a)
plt.subplot(4,2,4)
plt.plot(d)
#第二层
plt.subplot(4,4,9)
plt.plot(aa)
plt.subplot(4,4,10)
plt.plot(ad)
plt.subplot(4,4,11)
plt.plot(dd)
plt.subplot(4,4,12)
plt.plot(da)
#第三层
plt.subplot(4,8,25)
plt.plot(aaa)
plt.subplot(4,8,26)
plt.plot(aad)
plt.subplot(4,8,27)
plt.plot(add)
plt.subplot(4,8,28)
plt.plot(ada)
plt.subplot(4,8,29)
plt.plot(dda)
plt.subplot(4,8,30)
plt.plot(ddd)
plt.subplot(4,8,31)
plt.plot(dad)
plt.subplot(4,8,32)
plt.plot(daa)

'''
new_wp = pywt.WaveletPacket(data=None, wavelet='db1', mode='symmetric')
new_wp['a'] = wp['a'].data
#new_wp['d'] = wp['d'].data
#new_wp['aa'] = wp['aa'].data
#new_wp['ad'] = wp['ad'].data
#new_wp['da'] = wp['da'].data
#new_wp['dd'] = wp['dd'].data
new_data = new_wp.reconstruct(update=False)
print(new_data)
'''

re = []  #第n层所有节点的分解系数
for i in [node.path for node in wp.get_level(max_level, 'freq')]:
    re.append(wp[i].data)

#第n层能量特征
energy = []
for i in re:
    energy.append(np.linalg.norm(i,ord=2))


# 创建一个点数为 8 x 6 的窗口, 并设置分辨率为 80像素/每英寸
plt.figure(figsize=(10, 7), dpi=80)
# 再创建一个规格为 1 x 1 的子图
# plt.subplot(1, 1, 1)
# 柱子总数
N = 2**max_level
values = energy
# 包含每个柱子下标的序列
index = np.arange(N)
# 柱子的宽度
width = 0.45
# 绘制柱状图, 每根柱子的颜色为紫罗兰色
p2 = plt.bar(index, values, width, label="num", color="#87CEFA")
# 设置横轴标签
plt.xlabel('clusters')
# 设置纵轴标签
plt.ylabel('number of reviews')
# 添加标题
plt.title('Cluster Distribution')
# 添加纵横轴的刻度
#plt.xticks(index, ('7', '8', '9', '10', '11', '12', '13', '14'))
# plt.yticks(np.arange(0, 10000, 10))
# 添加图例
plt.legend(loc="upper right")
plt.show()